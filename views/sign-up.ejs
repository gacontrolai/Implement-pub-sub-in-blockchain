<!--
=========================================================
* Argon Dashboard 2 - v2.0.2
=========================================================

* Product Page: https://www.creative-tim.com/product/argon-dashboard
* Copyright 2022 Creative Tim (https://www.creative-tim.com)
* Licensed under MIT (https://www.creative-tim.com/license)
* Coded by Creative Tim

=========================================================

* The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.
-->
<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
		<link rel="apple-touch-icon" sizes="76x76" href="./assets/img/apple-icon.png" />
		<link rel="icon" type="image/png" href="./assets/img/favicon.png" />
		<title>Sign Up</title>
		<!--     Fonts and icons     -->
		<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet" />
		<!-- Nucleo Icons -->
		<link href="./assets/css/nucleo-icons.css" rel="stylesheet" />
		<link href="./assets/css/nucleo-svg.css" rel="stylesheet" />
		<!-- Font Awesome Icons -->
		<script src="https://kit.fontawesome.com/42d5adcbca.js" crossorigin="anonymous"></script>
		<link href="./assets/css/nucleo-svg.css" rel="stylesheet" />
		<!-- CSS Files -->
		<link id="pagestyle" href="./assets/css/argon-dashboard.css?v=2.0.2" rel="stylesheet" />
		<link href="./assets/css/loader.css" rel="stylesheet" />
	</head>
	<body class="">
		<main class="main-content mt-0">
			<div
				class="page-header align-items-start min-vh-50 pt-5 pb-11 m-3 border-radius-lg"
				style="background-image: url('https://raw.githubusercontent.com/creativetimofficial/public-assets/master/argon-dashboard-pro/assets/img/signup-cover.jpg'); background-position: top"
			>
				<span class="mask bg-gradient-dark opacity-6"></span>
				<div class="container">
					<div class="row justify-content-center">
						<div class="col-lg-5 text-center mx-auto">
							<h1 class="text-white mb-2 mt-5">Welcome!</h1>
							<p class="text-lead text-white">Register account free to access the system.</p>
						</div>
					</div>
				</div>
			</div>
			<div class="container">
				<div class="row mt-lg-n10 mt-md-n11 mt-n10 justify-content-center">
					<div class="col-xl-4 col-lg-5 col-md-7 mx-auto">
						<div class="card z-index-0">
							<div class="card-header text-center pt-4">
								<h3>Register</h3>
							</div>
							<div class="card-body">
								<form
									method="POST"
									id="register-form"
									role="form"
									action="/register"
									class="needs-validation"
									novalidate
									autocomplete="off"
									oninput="confirm.setCustomValidity(confirm.value != password.value ? 'Passwords do not match.' : '')"
								>
									<div class="mb-3">
										<input type="text" class="form-control" placeholder="Username" name="username" required />
									</div>
									<div class="mb-3">
										<input type="password" class="form-control" placeholder="Password" name="password" required />
									</div>
									<div class="mb-3">
										<input type="password" class="form-control" placeholder="Enter password again" id="confirm" name="re-password" required />
										<div class="invalid-feedback">Password not match</div>
									</div>
									<div class="mb-3">
										<input type="text" class="form-control" placeholder="Blockchain address" name="address" id="address" required readonly />
									</div>
									<div class="form-check">
										<input class="form-check-input" type="radio" name="userType" value="DU" id="flexRadioDefault1" required />
										<label class="form-check-label" for="flexRadioDefault1"> <b>Data User</b> </label>
									</div>
									<div class="form-check">
										<input class="form-check-input" type="radio" name="userType" value="DO" id="flexRadioDefault2" />
										<label class="form-check-label" for="flexRadioDefault2"> <b>Aggregator</b> </label>
										<div class="invalid-feedback">Please choose one type of user</div>
									</div>

									<div class="text-center">
										<button type="submit" class="btn bg-gradient-dark w-100 my-4 mb-2">Sign up</button>
									</div>
									<p class="text-sm mt-3 mb-0">Already have an account? <a href="/sign-in" class="text-dark font-weight-bolder">Sign in</a></p>
								</form>
							</div>
						</div>
					</div>
				</div>
			</div>
		</main>

		<!-- -------- START FOOTER 3 w/ COMPANY DESCRIPTION WITH LINKS & SOCIAL ICONS & COPYRIGHT ------- -->
		<footer class="footer py-5">
			<div class="container">
				<div class="row">
					<div class="col-lg-8 mx-auto text-center mb-4 mt-2">
						<a href="javascript:;" target="_blank" class="text-secondary me-xl-4 me-4">
							<span class="text-lg fab fa-dribbble"></span>
						</a>
						<a href="javascript:;" target="_blank" class="text-secondary me-xl-4 me-4">
							<span class="text-lg fab fa-twitter"></span>
						</a>
						<a href="javascript:;" target="_blank" class="text-secondary me-xl-4 me-4">
							<span class="text-lg fab fa-instagram"></span>
						</a>
						<a href="javascript:;" target="_blank" class="text-secondary me-xl-4 me-4">
							<span class="text-lg fab fa-pinterest"></span>
						</a>
						<a href="javascript:;" target="_blank" class="text-secondary me-xl-4 me-4">
							<span class="text-lg fab fa-github"></span>
						</a>
					</div>
				</div>
			</div>
		</footer>
		<div class="loader-wrapper">
			<div class="contain-loader">
				<div class="status-gif"></div>
				<span class="loader"><span class="loader-inner"></span></span>
				<div class="text-wrapper">
					<p class="loader-text">Loading ....</p>
				</div>
			</div>
		</div>

		<!-- -------- END FOOTER 3 w/ COMPANY DESCRIPTION WITH LINKS & SOCIAL ICONS & COPYRIGHT ------- -->
		<!--   Core JS Files   -->
		<script src="/js/core/jquery.min.js"></script>
		<script src="./assets/js/core/popper.min.js"></script>
		<script src="./assets/js/core/bootstrap.min.js"></script>
		<script src="./assets/js/plugins/perfect-scrollbar.min.js"></script>
		<script src="./assets/js/plugins/smooth-scrollbar.min.js"></script>
		<script>
			var win = navigator.platform.indexOf("Win") > -1;
			if (win && document.querySelector("#sidenav-scrollbar")) {
				var options = {
					damping: "0.5",
				};
				Scrollbar.init(document.querySelector("#sidenav-scrollbar"), options);
			}
		</script>
		<!-- Github buttons -->
		<script async defer src="https://buttons.github.io/buttons.js"></script>
		<!-- Control Center for Soft Dashboard: parallax effects, scripts for the example pages etc -->
		<script src="./assets/js/argon-dashboard.min.js?v=2.0.2"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.4.0/web3.min.js"></script>
		<script src="/javascripts/init.js"></script>
		<script>
			$(".loader-wrapper").hide();

			var myForm = document.getElementById("register-form");
			// myForm.submit(function (event) {
			// 	if (!myForm.checkValidity()) {
			// 		event.preventDefault();
			// 		event.stopPropagation();
			// 	}

			// 	myForm.addClass("was-validated");
			// });
			document.getElementById("register-form").addEventListener("submit", function (event) {
				myForm.classList.add("was-validated");
				event.preventDefault();
				if (!myForm.checkValidity()) {
					event.stopPropagation();
					return;
				}
				$(".loader-wrapper").css("display", "flex");
				$(".loader").show();
				var form = $(this);
				var actionUrl = form.attr("action");

				$.ajax({
					type: "POST",
					url: actionUrl,
					data: form.serialize(), // serializes the form's elements.
					success: function (data) {
						$(".loader-text").addClass("text-success").text("Successful registration");
						$(".status-gif").addClass("success-gif");
						$(".loader").hide();
						setTimeout(() => {
							$(".loader-wrapper").css("display", "none");
							window.location.href = "/sign-in";
						}, 5000);
					},
					error: function (data) {
						console.log(data);
						$(".loader-text")
							.addClass("text-danger")
							.text("Can not register due to: " + data.responseText);
						$(".status-gif").addClass("fail-gif");
						$(".loader").hide();
						setTimeout(() => {
							$(".loader-wrapper").css("display", "none");
						}, 5000);
					},
				});
			});
		</script>
		<script>
			ethereum.on("accountsChanged", function (accounts) {
				var account = Web3.utils.toChecksumAddress(accounts[0]);
				$("#address").val(account);
			});
			$(document).ready(async function () {
				var account = Web3.utils.toChecksumAddress(await getCurrentAccount());
				$("#address").val(account);
			});
		</script>
	</body>
</html>
